import{r as v,d as c,a as t,b as a,s as E,e as Y,F,g as A,t as l,w as $,O as N,o as i,f as S}from"./app-1d2e6a6e.js";import{_}from"./Icon-7841912a.js";import{_ as G}from"./Pagination2-8f389f92.js";import{_ as B}from"./TextInput-d602c319.js";import{_ as J}from"./Input-7579c0e8.js";import{_ as Q}from"./DialogModal-ca3d7b2e.js";import{h as X}from"./moment-fbc5633a.js";import"./index-d10eccd0.js";import{_ as Z}from"./SecondaryButton-493a758e.js";import"./Modal-5f6c2be1.js";const tt={class:"flex justify-between mt-2"},st={class:"flex gap-2"},et={class:"flex gap-2"},ot={class:"flex"},lt=t("span",{class:"text-md mt-2 mr-2"},"From",-1),at={class:"flex"},ct=t("span",{class:"text-md mt-2 mr-2"},"To",-1),it={class:"flex"},nt=["href"],dt={class:"text-gray-600 bg-white rounded-lg py-5 px-3 mb-5 mt-2"},_t={class:"container mx-auto"},rt={class:"relative overflow-x-auto"},ut={class:"w-full text-sm text-left text-gray-500"},pt=t("thead",{class:"text-xs text-white uppercase bg-yellow-500"},[t("tr",null,[t("th",{scope:"col",class:"px-6 py-3"},"Transaction ID"),t("th",{scope:"col",class:"px-6 py-3"},"Processed by"),t("th",{scope:"col",class:"px-6 py-3"},"Status"),t("th",{scope:"col",class:"px-6 py-3"}," Payment Method & Customer Type "),t("th",{scope:"col",class:"px-6 py-3"},"Tax & Discount"),t("th",{scope:"col",class:"px-6 py-3"},"Total Discount & VAT"),t("th",{scope:"col",class:"px-6 py-3"},"Total Paid"),t("th",{scope:"col",class:"px-6 py-3"},"Customer Cash"),t("th",{scope:"col",class:"px-6 py-3"},"Customer Change"),t("th",{scope:"col",class:"px-6 py-3"},"Total Unsuccess"),t("th",{scope:"col",class:"px-6 py-3"},"Created at")])],-1),mt=["onClick"],ht={class:"px-6 py-4"},xt={class:"px-6 py-4"},ft={class:"flex gap-2"},yt=["src","alt"],gt={class:"px-6 py-4"},vt={key:0,class:"flex gap-1"},bt=t("span",{class:"bg-green-400 rounded-md p-1 text-white"}," Success ",-1),wt={key:1,class:"flex gap-1"},kt=t("span",{class:"bg-orange-400 rounded-md p-1 text-white"}," Unsuccess ",-1),St={class:"px-6 py-4"},Tt={class:"flex p-1 w-[8vmin]"},Vt={key:0,class:"flex gap-1"},Ct=t("small",{class:"bg-green-400 rounded-md p-1 text-white w-full"}," Walk-in ",-1),Dt={key:1,class:"flex gap-1"},zt=t("small",{class:"bg-orange-400 rounded-md p-1 text-white"}," Regular ",-1),Pt={class:"flex"},$t={key:0,class:"flex gap-1"},qt={key:1},Ft={class:"px-6 py-4"},Nt={class:"flex rounded-lg bg-red-400 p-[3px] text-white"},Ut=t("small",null,"VAT: ",-1),Kt={class:"flex rounded-lg bg-orange-400 p-[3px] text-white mt-1"},jt=t("small",null,"SD: ",-1),Et={class:"px-6 py-4"},Yt={class:"flex rounded-lg bg-red-400 p-[3px] text-white"},At={class:"flex"},Bt={class:"flex rounded-lg bg-orange-400 p-[3px] text-white mt-1"},It={class:"flex"},Mt={class:"px-6 py-4"},Ot={class:"px-6 py-4"},Rt={class:"px-6 py-4"},Ht={class:"px-6 py-4"},Lt={class:"px-6 py-4 flex gap-2"},Wt={class:"flex items-center justify-between"},Gt={class:"mt-6 text-sm text-gray-500"},Jt={class:"text-gray-600 truncate"},Qt={class:"w-full text-xs text-left text-gray-500"},Xt=t("thead",{class:"text-xs text-gray-700 uppercase bg-gray-100"},[t("tr",null,[t("th",{scope:"col",class:"px-1 py-1 flex"},"Product"),t("th",{scope:"col",class:"px-1 py-1"},"No."),t("th",{scope:"col",class:"px-1 py-1"},"Price"),t("th",{scope:"col",class:"px-1 py-1"},"Discount %"),t("th",{scope:"col",class:"px-1 py-1"},"Status"),t("th",{scope:"col",class:"px-1 py-1"},"Total Discount"),t("th",{scope:"col",class:"px-1 py-1"},"Sub-total")])],-1),Zt={class:"px-1 py-1 flex"},ts={class:"w-[20vmin] break-words"},ss={class:"px-1 py-1"},es={class:"px-1 py-1"},os={class:"px-1 py-1"},ls={class:"px-1 py-1"},as={key:0,class:"bg-orange-400 rounded-sm p-[1px] text-white"},cs={key:1,class:"bg-green-400 rounded-sm p-[1px] text-white"},is={key:2,class:"bg-orange-400 rounded-sm p-[1px] text-white"},ns={key:3,class:"bg-red-400 rounded-sm p-[1px] text-white"},ds={class:"px-1 py-1"},_s={class:"px-1 py-1"},ws={__name:"TransactionList",props:["transactions","date_from","date_to","search"],setup(q){const T=q,m=v(T.date_from),h=v(T.date_to),y=v(T.search),V=v(!1),U=v(),K=v(),I=e=>X(e).format("MM/DD/YYYY, h:mm:ss a"),u=e=>{let n=new Intl.NumberFormat("en-PH",{style:"currency",currency:"PHP",minimumFractionDigits:2,maximumFractionDigits:20,minimumSignificantDigits:1,maximumSignificantDigits:20}).format(e).split("."),p=String(n[1]).slice(0,2),x=p=="un"?"00":p;return String(n[0])+"."+x},M=()=>{N.get(route("transactions.index",{date_from:m.value,date_to:h.value}))},O=()=>{N.get(route("transactions.index",{search:y.value,date_from:m.value,date_to:h.value}))},R=()=>{N.get(route("transactions.index",{date_from:null,date_to:null,search:null}))},H=e=>{let o=0,s=e.sale_discount.discount/100;if(e.status==1)for(let n=0;n<e.quantity;n++)o+=e.price.price*s;return o},L=e=>{let o=0,s=0,n=e.sale_discount.discount/100;if(e.status==1||e.status==2)for(let d=0;d<e.quantity;d++)s=e.price.price*n,o+=e.price.price-s;else o+=e.price.price*e.quantity;return o},C=(e,o,s,n)=>{let d=0,p=0,x=0,f=0,g=0,D=o/100,z=s/100;if(e.forEach(r=>{let b=0,w=0,P=r.sale_discount.discount/100;if(r.status==1||r.status==2||r.status==3)for(let k=0;k<r.quantity;k++)w=r.price.price*P,b+=r.price.price-w;d+=b}),f=d*D,p=d-f,g=p*z,x=p+g,n==0)return x;if(n==1)return g;if(n==2)return f},W=e=>{let o=0;return e.forEach(s=>{s.status==0&&(o+=s.price.price*s.quantity)}),o};return(e,o)=>(i(),c(F,null,[t("div",tt,[t("div",st,[t("div",et,[t("div",ot,[lt,a(B,{id:"date_from",modelValue:m.value,"onUpdate:modelValue":o[0]||(o[0]=s=>m.value=s),type:"date",class:"mt-1 block w-full"},null,8,["modelValue"])]),t("div",at,[ct,a(B,{id:"date_to",modelValue:h.value,"onUpdate:modelValue":o[1]||(o[1]=s=>h.value=s),type:"date",class:"mt-1 block w-full",onKeyup:E(M,["enter"])},null,8,["modelValue","onKeyup"])]),t("div",it,[a(J,{modelValue:y.value,"onUpdate:modelValue":o[2]||(o[2]=s=>y.value=s),class:"rounded-lg w-[30vmin]",type:"text",label:"Search transaction",onKeyup:E(O,["enter"])},null,8,["modelValue","onKeyup"])]),m.value||h.value||y.value?(i(),c("button",{key:0,class:"h-10 my-auto mt-5",onClick:R},[a(_,{icon:"close_icon",size:"sm"})])):Y("",!0)])]),t("a",{href:e.route("transactions.export",{date_from:m.value,date_to:h.value,search:y.value}),class:"bg-green-400 hover:bg-green-600 hover:text-white rounded-lg my-auto p-2"},"Export Transaction",8,nt)]),t("section",dt,[t("div",_t,[t("div",rt,[t("table",ut,[pt,t("tbody",null,[(i(!0),c(F,null,A(q.transactions.data,(s,n)=>{var d,p,x,f,g,D,z,r,b,w,P,k,j;return i(),c("tr",{key:n,class:"bg-white hover:bg-gray-100 cursor-pointer",onClick:rs=>(V.value=!0,U.value=s.transaction_details,K.value=s.id)},[t("td",ht,l(s.id),1),t("td",xt,[t("small",ft,[t("img",{class:"h-8 w-8 rounded-full object-cover",src:s.accommodate_by.profile_photo_url,alt:s.accommodate_by.name},null,8,yt),S(" "+l(((d=s.accommodate_by)==null?void 0:d.name)??"Pending"),1)])]),t("td",gt,[s.status==1?(i(),c("div",vt,[a(_,{icon:"check",size:"sm"}),bt])):(i(),c("div",wt,[a(_,{icon:"wrong",size:"xs"}),kt]))]),t("td",St,[t("div",Tt,[s.customer_type==0?(i(),c("div",Vt,[a(_,{icon:"user",size:"md"}),Ct])):(i(),c("div",Dt,[a(_,{icon:"user",size:"md"}),zt]))]),t("div",Pt,[s.payment_method==0?(i(),c("small",$t,[a(_,{icon:"cash",size:"sm"}),S(" Cash ")])):(i(),c("small",qt,"Other"))])]),t("td",Ft,[t("div",Nt,[a(_,{icon:"tax",size:"sm"}),Ut,t("small",null,l((p=s.tax)==null?void 0:p.tax)+"% ",1)]),t("div",Kt,[a(_,{icon:"wheelchair",size:"sm"}),jt,t("small",null,l(((x=s.special_discount)==null?void 0:x.discount)??"0")+"%",1)])]),t("td",Et,[t("div",Yt,[t("small",At,[a(_,{icon:"tax",size:"sm"}),S("VAT: ")]),t("small",null,l(u(C(s.transaction_details,((f=s.special_discount)==null?void 0:f.discount)??0,((g=s.tax)==null?void 0:g.tax)??0,1))),1)]),t("div",Bt,[t("small",It,[a(_,{icon:"wheelchair",size:"sm"}),S("SD: ")]),t("small",null,l(u(C(s.transaction_details,((D=s.special_discount)==null?void 0:D.discount)??0,((z=s.tax)==null?void 0:z.tax)??0,2))),1)])]),t("td",Mt,l(u(C(s.transaction_details,((r=s.special_discount)==null?void 0:r.discount)??0,((b=s.tax)==null?void 0:b.tax)??0,0))),1),t("td",Ot,l(u(s.cash)),1),t("td",Rt,l(u(s.cash-C(s.transaction_details,((w=s.special_discount)==null?void 0:w.discount)??0,((P=s.tax)==null?void 0:P.tax)??0,0))),1),t("td",Ht,l(u(W(s.transaction_details,((k=s.special_discount)==null?void 0:k.discount)??0,((j=s.tax)==null?void 0:j.tax)??0))),1),t("td",Lt,[a(_,{icon:"calendar",size:"md"}),t("small",null,l(I(s.created_at)),1)])],8,mt)}),128))])])]),t("div",Wt,[a(G,{links:T.transactions.links,date_from:m.value,date_to:h.value,search:y.value},null,8,["links","date_from","date_to","search"]),t("p",Gt," Showing "+l(q.transactions.data.length)+" Transactions ",1)])])]),a(Q,{show:V.value,maxWidth:"2xl",onClose:o[4]||(o[4]=s=>V.value=!1)},{title:$(()=>[t("span",Jt," Sale details for Transaction ID("+l(K.value)+")",1)]),content:$(()=>[t("table",Qt,[Xt,t("tbody",null,[(i(!0),c(F,null,A(U.value,(s,n)=>{var d;return i(),c("tr",{key:n,class:"bg-white border-"},[t("td",Zt,[a(_,{icon:"shopping_cart",size:"xs"}),t("p",ts,l((d=s.product)==null?void 0:d.name),1)]),t("td",ss,l(s.quantity),1),t("td",es,l(u(s.price.price)),1),t("td",os,l(s.sale_discount.discount)+"% ",1),t("td",ls,[s.status==0?(i(),c("small",as," Unsuccess ")):s.status==1?(i(),c("small",cs," Success ")):s.status==2?(i(),c("small",is," Pending Return ")):s.status==3?(i(),c("small",ns," Returned ")):Y("",!0)]),t("td",ds,[t("small",null,l(u(H(s))),1)]),t("td",_s,[t("small",null,l(u(L(s))),1)])])}),128))])])]),footer:$(()=>[a(Z,{class:"mr-2 bg-red-300",onClick:o[3]||(o[3]=s=>V.value=!1)},{default:$(()=>[S(" Close ")]),_:1})]),_:1},8,["show"])],64))}};export{ws as default};
